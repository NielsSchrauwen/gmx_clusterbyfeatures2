How to use gmx_clusterByFeatures?
=================================

It takes at least three input files and perform clustering according to the
given option. It also generate a log file containing the information related
to clustering.

* gmx_clusterByFeatures can be used with trajectory file generated by any GROMACS
  version. However, tpr file is supported depending on the version (2016.x or 2018.x)
  used during the installation.
* In case of other versions or other programs such as NAMD and AMBER, PDB file
  can be used in place of tpr file.
* Trajectories from NAMD and AMBER should be converted to GROMACS compatible
  formats such as trr, xtc, pdb etc.

**Execute following command to get full help**

.. code-block:: bash

    gmx_clusterByFeatures -h

.. warning:: Only PBC corrected trajectory and tpr files should be used as inputs.
             PBC corrected PDB/GRO file can be used in place of tpr file.

command
-------

.. code-block:: bash

  gmx_clusterByFeatures [-f [<.xtc/.trr/...>]] [-s [<.tpr/.gro/...>]]
           [-feat [<.xvg>]] [-n [<.ndx>]] [-clid [<.xvg>]] [-g [<.log>]]
           [-fout [<.xtc/.trr/...>]] [-cpdb [<.pdb>]] [-rmsd [<.xvg>]]
           [-b <time>] [-e <time>] [-dt <time>] [-xvg <enum>]
           [-method <enum>] [-nfeature <int>] [-cmetric <enum>]
           [-ncluster <int>] [-crmsthres <real>] [-ssrchange <real>]
           [-db_eps <real>] [-db_min_samples <int>] [-nminfr <int>]
           [-[no]fit] [-[no]fit2central] [-sort <enum>] [-plot <string>]
           [-fsize <int>] [-pltw <real>] [-plth <real>]

Options
-------

.. list-table:: Options to specify input files to gmx_clusterByFeatures
    :widths: 1, 1, 4
    :header-rows: 1
    :name: input-files-table
    :stub-columns: 1
    :align: left

    * - Option
      - Default
      - File type

    * - :ref:`cmdline:-f [\<.xtc/.trr/...\>]`
      - traj.xtc
      - Trajectory: xtc trr cpt gro g96 pdb tng

    * - :ref:`cmdline:-s [\<.tpr/.gro/...\>]`
      - topol.tpr
      - Structure+mass(db): tpr gro g96 pdb brk ent

    * - :ref:`cmdline:-n [\<.ndx\>]`
      - index.ndx
      - Index file

    * - :ref:`cmdline:-feat [\<.xvg\>]`
      - feature.xvg
      - xvgr/xmgr file


.. list-table:: Options to specify output files to gmx_clusterByFeatures
    :widths: 1, 1, 4
    :header-rows: 1
    :name: output-files-table
    :stub-columns: 1
    :align: left

    * - Option
      - Default
      - File type

    * - :ref:`cmdline:-clid [\<.xvg\>]`
      - clid.xvg
      - xvgr/xmgr file (Can be used as both input and output)

    * - :ref:`cmdline:-g [\<.log\>]`
      - :ref:cluster.log
      - Log file

    * - :ref:`cmdline:-fout [\<.xtc/.trr/...\>]`
      - trajout.xtc
      - Trajectory: xtc trr cpt gro g96 pdb tng

    * - :ref:`cmdline:-cpdb [\<.pdb\>]`
      - central.pdb
      - Protein data bank file

    * - :ref:`cmdline:-rmsd [\<.xvg\>]`
      - rmsd.xvg
      - xvgr/xmgr file

.. list-table:: Other options to gmx_clusterByFeatures
    :widths: 1, 1, 4
    :header-rows: 1
    :name: other-options-table
    :stub-columns: 1
    :align: left

    * - Option
      - Default
      - Description

    * - ``-b``
      - 0
      - First frame (ps) to read from trajectory

    * - ``-e``
      - 0
      - Last frame (ps) to read from trajectory

    * - ``-dt``
      - 0
      - Only use frame when t MOD dt = first time (ps)

    * - :ref:`cmdline:-xvg \<keyword\>`
      - xmgrace
      - xvg plot formatting: xmgrace, xmgr, none

    * - :ref:`cmdline:-method \<keyword\>`
      - kmeans
      - Clustering methods. Accepted methods are:: kmeans, dbscan, gmixture

    * - :ref:`cmdline:-nfeature \<int\>`
      - 10
      - Number of features to use for clustering

    * - :ref:`cmdline:-cmetric \<keyword\>`
      - prior
      - Cluster metrics: Method to determine cluster number. Accepted
        methods are: prior, rmsd, ssr-sst, pFS, DBI

    * - :ref:`cmdline:-ncluster \<int\>`
      - 5
      - Number of clusters to generate for prior method. Maximum number of
        cluster for ctrmsd method.

    * - :ref:`cmdline:-crmsthres \<real\>`
      - 0.1
      - RMSD (nm) threshold between central structures for RMSD cluster metric
        method.

    * - :ref:`cmdline:-ssrchange \<real\>`
      - 2
      - Thershold relative change % in SSR/SST ratio for ssr-sst cluster
        metric method.

    * - :ref:`cmdline:-db_eps \<real\>`
      - 0.5
      - The maximum distance between two samples for them to be considered
        as in the same neighborhood.

    * - :ref:`cmdline:-db_min_samples \<int\>`
      - 20
      - The number of samples (or total weight) in a neighborhood for a
        point to be considered as a core point. This includes the point
        itself.

    * - :ref:`cmdline:-nminfr \<int\>`
      - 20
      - Number of minimum frames in a cluster to output it as trajectory

    * - :ref:`cmdline:-[no]fit`
      - Enable
      - Enable fitting and superimposition of the atoms groups different from RMSD/clustering group before RMSD calculation.

    * - :ref:`cmdline:-[no]fit2central`
      - Disable
      - Enable/Disable trajectory superimposition or fitting to central structure in the output trajectory

    * - :ref:`cmdline:-sort  \<keyword\>`
      - none
      - Sort trajectory according to these values. Accepted methods are:
        none, rmsd, features, user

    * - :ref:`cmdline:-plot  \<string\>`
      - pca_cluster.png
      - To plot features with clusters in this file.

    * - ``-fsize  <int>``
      - 14
      - Font size in plot.

    * - ``-pltw  <real>``
      - 12
      - Width (inch) of the plot.

    * - ``-plth  <real>``
      - 20
      - Height (inch) of the plot.
